<html>
    <head>
        <link rel="stylesheet" href="/assets/home.css">
    </head>
<div class="header">
<h2 class="title">Codeial</h2>
<div class="right">
    <div class="dropdown">
        <div class="icon" style="width: 2em;"><img src="https://www.flaticon.com/premium-icon/icons/svg/2985/2985052.svg" alt=""></div>
        <ul class="dropdown-content">
            <li class="notification"><a href=""></a></li>
            <%for(var request of Requests){%>
                <li class="notification">
                    <div class="user">
                        <img src="<%=request.avatar%>" alt="profilePic">
                        <div class="name"><%=request.name%></div>
                        <div class="react">
                            <a href="/Auth/Friends/accept/<%=request.id%>">Accept</a>
                            <a href="/Auth/Friends/reject/<%=request.id%>">Decline</a>
                        </div>
                    </div>
                </li>
            <%}%>
        </ul>
    </div>
    <div class="dropdown">
            <div class="icon"><img src="https://image.flaticon.com/icons/svg/561/561127.svg" alt=""></div>
            <div class="count">1</div>
            <ul class="dropdown-content">
                <li class="notification">
                    <div class="messageNotification" id="5eefc9e61a341323d44c0505">
                                S has sent u message
                    </div>
                </li>
            </ul>
    </div>
    <form action="/Auth/logout" method="POST">
    <input type="submit" value="logout">
    </form>
</div>
</div>

<div class="Home">

<div class="left">
<form action="/Auth/post/create-post" method="POST" class="MakePost">

<textarea name="content" id="" cols="30" rows="2" placeholder="Write Something here ...."></textarea>
<input type="submit" value="post">
</form>
<div class="PostList">
    <%for(var post of posts){%>
        <div class="Post">
            <% var isLiked=post.Likes.some(function(id){return id.equals(user.id)})%>
            
            <%if(String(post.CreatedUser)==String(user.id)){%>   
            <a href="/Auth/post/delete-post/<%=post.id%>" ><img class="icon" src="https://image.flaticon.com/icons/svg/271/271203.svg"></a>
            <%}%>
            <div class="content">
                <%=post.content%>
            </div>
            <%if(!isLiked){%>
            <div class="like"><%=post.Likes.length%><a href="/Auth/post/like/<%=post.id%>"><img  src="https://image.flaticon.com/icons/svg/633/633759.svg"></a></div>
            <%}else{%>
                <div class="like"><%=post.Likes.length%><a href="/Auth/post/unlike/<%=post.id%>"><img  src="https://image.flaticon.com/icons/svg/889/889140.svg"></a></div>
            <%}%>
            <form action="/Auth/comment/create-comment/<%=post.id%>" class="commentBox" method="POST">
                <textarea name="content"  cols="20" rows="2" placeholder="Comment here ...."></textarea>
                <br>
                <input type="submit" value="comment">
            </form>
            <hr style="width: 100%;">
            <div class="commentList">
                <%for(var comment of post.comments){%>
                    <div class="comment">
                        <% var isLiked=comment.Likes.some(function(id){return id.equals(user.id)})%>
                            <div class="content">
                                    <%=comment.content%>
                            </div>
                            <%if(!isLiked){%>
                                <div class="like" style="width: 2em;"><%=comment.Likes.length%><a href="/Auth/comment/like/<%=comment.id%>"><img  src="https://image.flaticon.com/icons/svg/633/633759.svg"></a></div>
                                <%}else{%>
                                    <div class="like" style="width: 2em;"><%=comment.Likes.length%><a href="/Auth/comment/unlike/<%=comment.id%>"><img  src="https://image.flaticon.com/icons/svg/889/889140.svg"></a></div>
                            <%}%>
                            <div class="options">
                                <a href="">delete</a>
                            </div>
                    </div>
                <%}%>
            </div>
        </div>
    <%}%>
</div>
</div>
<div class="right">
    <h2>Friends</h2>
    <div class="list">
        <%for(var friend of Friends){%>
        
        <div class="item">
            <a href="/Auth/Friends/profile/<%=friend.id%>"><img src="<%=friend.avatar%>" alt="profile"></a>
            <div class="name"><%=friend.name%></div>
            <div class="icon"><a href="/Auth/Friends/remove/<%=friend.id%>">unfriend</a></div>
            <div class="icon"><a id="<%=friend.id%>" class="chat">Message</a></div>
        </div>
        <%}%>
    </div>
    <h2>Users</h2>
    <temp attr="<%=user.id%>"></temp>
<div class="list">
    <%for(var userItem of users){%>
    <%if(String(userItem.id)!=String(user.id)){%>
    <div class="item">
        <a href="/Auth/Friends/profile/<%=userItem.id%>"><img src="<%=userItem.avatar%>" alt="profile"></a>
        <div class="name"><%=userItem.name%></div>
        
        <% var isRequestSent=userItem.Requests.some(function(id){return id.equals(user.id)})%>
        <%if(!isRequestSent){%>
        <div class="icon"><a href="/Auth/Friends/add-friend/<%=userItem.id%>">Add Friend</a></div>
        <%}else{%>
            <div class="icon"><a href="/Auth/Friends/add-friend/<%=userItem.id%>" >Request Sent</a></div>   
        <%}%>
        <div class="icon"><a id="<%=userItem.id%>" class="chat">Message</a></div>
    </div>
    <%}%>
    <%}%>
</div>
</div>

<div class="container" id='room'>
    <div class="messageList">

        <div class="messageBox recievedMessage">
            <div>Hello</div>
            <sub>16.20</sub>
        </div>
        <div class="username textLeft">Sarvanan</div>
        <div >
            <div class="sendMessage messageBox">
            <div class="message">Hello</div>
            <sub class="time">16.20</sub>
            </div>
            <div class="username textRight">Sarvanan</div>
        </div>
        
        
    </div>
    <div class="messageContainer">
                <input type="text" placeholder="message" class="message"  style="width: 75%;">
                <input type="submit" class ="send"  value="Send" width="30%" style="width: 25%;">
    </div>
    
</div>
</div>
<script src="https://code.jquery.com/jquery-3.5.1.min.js" integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/2.3.0/socket.io.dev.js"></script>
<script src="/assets/chatEngine.js"></script>

</html>